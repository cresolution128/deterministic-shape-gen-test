<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Step2 — Deterministic Glyph Micro-Demo</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:#0b0f14;color:#e8eef6;margin:12px}
  .wrap{max-width:980px;margin:0 auto;display:grid;grid-template-columns:360px 1fr;gap:12px}
  .card{background:#0f1722;padding:12px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,.6);box-sizing:border-box;}
  label{display:block;font-size:12px;color:#9fb0c8;margin-top:8px}
  input,select{width:100%;max-width:100%;padding:8px;border-radius:6px;border:1px solid #223344;background:#071019;color:#eef;box-sizing:border-box;overflow:hidden;text-overflow:ellipsis;}
  button{margin-top:10px;padding:8px 10px;border-radius:6px;border:none;background:#2b9bd6;color:#04202d;cursor:pointer}
  #preview svg{width:512px;height:512px;border-radius:6px;background:#081018;display:block;margin:0 auto}
  small{color:#99b2c9}
  pre{white-space:pre-wrap;word-break:break-word;background:#071018;padding:8px;border-radius:6px;color:#bfe}
  .row{display:flex;gap:8px}
  .muted{color:#96adc6;font-size:12px}
  input[type=range]{width:100%;margin:0;height:2.2em;padding:0;background:transparent;box-sizing:border-box;}
</style>
</head>
<body>
  <h2>Step 2 — Deterministic Glyph Micro-Demo</h2>
  <div class="wrap">
    <div class="card">
      <div><small>Inputs (seed string will be SHA-256("HUID|ts|P,I,E,C|context|style|v12"))</small></div>
      <label>HUID <input id="huid" value="H-DET-001"/></label>
      <label>ts (timestamp)
        <div style="display:flex;gap:8px;align-items:center;">
          <input id="ts" value="1723654321123" style="flex:1;"/>
          <button id="tsNow" type="button" style="min-width:60px;">Now</button>
        </div>
      </label>
      <label style="display:flex;align-items:center;gap:8px;">
        <input id="useAnchor" type="checkbox" style="width:auto;">
        <span>Use Anchor (v12a|ANCHOR)</span>
      </label>
      <div style="margin-top:8px;">
        <div style="font-size:12px;color:#9fb0c8;margin-bottom:2px;">Energies</div>
        <label style="display:flex;align-items:center;gap:8px;margin-top:8px;">
          <span style="width:18px;">P</span>
          <input id="P" type="range" min="0" max="5" value="1" step="1" style="flex:1;" oninput="document.getElementById('P_val').textContent=this.value">
          <span id="P_val" style="min-width:16px;display:inline-block;text-align:right;">1</span>
        </label>
        <label style="display:flex;align-items:center;gap:8px;margin-top:8px;">
          <span style="width:18px;">I</span>
          <input id="I" type="range" min="0" max="5" value="0" step="1" style="flex:1;" oninput="document.getElementById('I_val').textContent=this.value">
          <span id="I_val" style="min-width:16px;display:inline-block;text-align:right;">0</span>
        </label>
        <label style="display:flex;align-items:center;gap:8px;margin-top:8px;">
          <span style="width:18px;">E</span>
          <input id="E" type="range" min="0" max="5" value="0" step="1" style="flex:1;" oninput="document.getElementById('E_val').textContent=this.value">
          <span id="E_val" style="min-width:16px;display:inline-block;text-align:right;">0</span>
        </label>
        <label style="display:flex;align-items:center;gap:8px;margin-top:8px;">
          <span style="width:18px;">C</span>
          <input id="C" type="range" min="0" max="5" value="2" step="1" style="flex:1;" oninput="document.getElementById('C_val').textContent=this.value">
          <span id="C_val" style="min-width:16px;display:inline-block;text-align:right;">2</span>
        </label>
      </div>
      <label>Context
        <select id="context">
          <option>verify</option><option>registration</option><option>payment_confirm</option>
          <option>contribution</option><option>access_grant</option><option>tx</option><option>other</option>
        </select>
      </label>
      <label>Style
        <select id="style">
          <option value="organica">organica</option>
          <option value="geometric">geometric</option>
          <option value="calligraphic" selected>calligraphic</option>
        </select>
      </label>
      <label>Palette
        <select id="palette">
          <option value="gold">Gold</option>
          <option value="red">Red</option>
          <option value="indigo">Indigo</option>
          <option value="copper">Copper</option>
          <option value="olo">Olo</option>
        </select>
      </label>
      <!-- Advanced Controls -->
      <div style="margin-top:12px;padding:8px 0 0 0;border-top:1px solid #223344;">
        <div style="font-size:12px;color:#9fb0c8;margin-bottom:2px;">Advanced Controls</div>
        <label style="display:flex;align-items:center;gap:8px;">
          <span style="width:90px;">pointsDensity</span>
          <input id="pointsDensity" type="range" min="80" max="360" step="5" value="220" style="flex:1;" oninput="document.getElementById('vPD').textContent=this.value">
          <span id="vPD" style="min-width:32px;display:inline-block;text-align:right;">220</span>
        </label>
        <label style="display:flex;align-items:center;gap:8px;">
          <span style="width:90px;">lineScale</span>
          <input id="lineScale" type="range" min="0.5" max="2.5" step="0.05" value="1.00" style="flex:1;" oninput="document.getElementById('vLS').textContent=this.value">
          <span id="vLS" style="min-width:32px;display:inline-block;text-align:right;">1.00</span>
        </label>
        <div id="geoBlock" style="display:none;">
          <div style="font-size:12px;color:#9fb0c8;margin-top:8px;">Geometric Only</div>
          <label style="display:flex;align-items:center;gap:8px;">
            <span style="width:90px;">raysLevel</span>
            <input id="raysLevel" type="range" min="0" max="100" step="1" value="60" style="flex:1;" oninput="document.getElementById('vR').textContent=this.value">
            <span id="vR" style="min-width:32px;display:inline-block;text-align:right;">60</span>
          </label>
        </div>
        <div id="calBlock" style="display:none;">
          <div style="font-size:12px;color:#9fb0c8;margin-top:8px;">Calligraphic Only</div>
          <label style="display:flex;align-items:center;gap:8px;">
            <span style="width:90px;">penMul</span>
            <input id="penMul" type="range" min="0.5" max="3.0" step="0.05" value="1.60" style="flex:1;" oninput="document.getElementById('vPM').textContent=this.value">
            <span id="vPM" style="min-width:32px;display:inline-block;text-align:right;">1.60</span>
          </label>
          <label style="display:flex;align-items:center;gap:8px;">
            <span style="width:90px;">penSmooth</span>
            <input id="penSmooth" type="range" min="0" max="3" step="1" value="2" style="flex:1;" oninput="document.getElementById('vPS').textContent=this.value">
            <span id="vPS" style="min-width:32px;display:inline-block;text-align:right;">2</span>
          </label>
        </div>
        <label style="display:flex;align-items:center;gap:8px;">
          <span style="width:90px;">wavesIntensity</span>
          <input id="wavesIntensity" type="range" min="0" max="1" step="0.05" value="0.6" style="flex:1;" oninput="document.getElementById('vWI').textContent=this.value">
          <span id="vWI" style="min-width:32px;display:inline-block;text-align:right;">0.60</span>
        </label>
        <label style="display:flex;align-items:center;gap:8px;">
          <input id="autoRegen" type="checkbox" style="width:auto;" checked>
          <span>Auto-regen on input change</span>
        </label>
        <div style="display:flex;gap:8px;margin-top:8px;">
          <button id="randE" type="button">Random energies</button>
        </div>
      </div>

      <div style="margin-top:8px" class="row">
        <button id="gen" style="border-color: white; border-width: 1px; border-style: solid;">Generate</button>
        <button id="exportSvg">Export SVG</button>
        <button id="exportPNG">Export PNG 512</button>
        <button id="exportPNG2k">Export PNG 1024</button>
      </div>

      <div style="margin-top:8px" class="row">
        <button id="exportJSON">Download JSON</button>
      </div>

      <div style="margin-top:8px">
        <button id="runT1">Run T1 (Determinism)</button>
        <div class="muted" style="margin-bottom:2px;font-size:13px;padding:5px;">(Checks if running 3x with same inputs gives identical results (hashes).)</div>
        <button id="runT2">Run T2 (Uniqueness N=200)</button>
        <div class="muted" style="font-size:13px;padding:5px;">(Checks if 200 runs with different timestamps produce unique seeds (no duplicates).)</div>
        <pre id="testReport">-</pre>
      </div>

      <div style="margin-top:10px">
        <div class="muted">seedHex:</div>
        <pre id="seedHexOut">-</pre>
        <div class="muted">hashHex (JSON):</div>
        <pre id="hashHexOut">-</pre>
      </div>
    </div>

    <div class="card">
      <div id="preview"><svg id="svgPreview" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"></svg></div>

      <h4>Controls & Validation</h4>
      <!-- Removed TV validation UI -->
      <h4>JSON (params & layers)</h4>
      <pre id="jsonOut">-</pre>
    </div>
  </div>

  <script src="main.js"></script>
</body>
</html>
